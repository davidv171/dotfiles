#!/usr/bin/env zsh

# A simple script which loads an associative array for dmenu

# Source configuration file
conf="$1"
opts=(-i -l 20)

if [[ -z "$conf" ]]; then
    echo "No configuration specified."
    return 1
else
    typeset -A index
    source "$conf"
fi

if ! hash "$cmd"; then
    echo "No command specified."
    return 1
fi

# Print the keys
selection=$(
    print -rl - "${(k)index[@]}" | command dmenu -p "${title:-Title}" "${(@)opts}"
)

# Pass the value from the array based on key selection
command "$cmd" "$index[$selection]"
